(function(){"use strict";var je={},oe={},L={},c={};Object.defineProperty(c,"__esModule",{value:!0}),c.areaConversion=c.timeConversion=c.distanceConversion=c.altitudeKeys=c.latitudeKeys=c.longitudeKeys=c.MAXLON=c.MINLON=c.MAXLAT=c.MINLAT=c.earthRadius=c.sexagesimalPattern=void 0;var kt=/^([0-9]{1,3})°\s*([0-9]{1,3}(?:\.(?:[0-9]{1,}))?)['′]\s*(([0-9]{1,3}(\.([0-9]{1,}))?)["″]\s*)?([NEOSW]?)$/;c.sexagesimalPattern=kt;var xt=6378137;c.earthRadius=xt;var Ut=-90;c.MINLAT=Ut;var Gt=90;c.MAXLAT=Gt;var Yt=-180;c.MINLON=Yt;var zt=180;c.MAXLON=zt;var Zt=["lng","lon","longitude",0];c.longitudeKeys=Zt;var Ht=["lat","latitude",1];c.latitudeKeys=Ht;var Jt=["alt","altitude","elevation","elev",2];c.altitudeKeys=Jt;var Qt={m:1,km:.001,cm:100,mm:1e3,mi:1/1609.344,sm:1/1852.216,ft:100/30.48,in:100/2.54,yd:1/.9144};c.distanceConversion=Qt;var er={m:60,h:3600,d:86400};c.timeConversion=er;var A={m2:1,km2:1e-6,ha:1e-4,a:.01,ft2:10.763911,yd2:1.19599,in2:1550.0031};c.areaConversion=A,A.sqm=A.m2,A.sqkm=A.km2,A.sqft=A.ft2,A.sqyd=A.yd2,A.sqin=A.in2;var B={};Object.defineProperty(B,"__esModule",{value:!0}),B.default=void 0;var tr=function(t,r){return r.reduce(function(a,n){if(typeof t>"u"||t===null)throw new Error("'".concat(t,"' is no valid coordinate."));return Object.prototype.hasOwnProperty.call(t,n)&&typeof n<"u"&&typeof a>"u"?(a=n,n):a},void 0)},rr=tr;B.default=rr;var F={},E={};Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var ar=function(t){var r=t.toString().trim();return isNaN(parseFloat(r))?!1:parseFloat(r)===Number(r)},nr=ar;E.default=nr;var q={};Object.defineProperty(q,"__esModule",{value:!0}),q.default=void 0;var ur=c,ir=function(t){return ur.sexagesimalPattern.test(t.toString().trim())},or=ir;q.default=or;var K={};Object.defineProperty(K,"__esModule",{value:!0}),K.default=void 0;var dr=c,lr=function(t){var r=new RegExp(dr.sexagesimalPattern).exec(t.toString().trim());if(typeof r>"u"||r===null)throw new Error("Given value is not in sexagesimal format");var a=Number(r[2])/60||0,n=Number(r[4])/3600||0,u=parseFloat(r[1])+a+n;return["S","W"].includes(r[7])?-u:u},fr=lr;K.default=fr;var k={},j={};Object.defineProperty(j,"__esModule",{value:!0}),j.default=void 0;var Ve=c,Xe=sr(B);function sr(e){return e&&e.__esModule?e:{default:e}}function ot(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function cr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ot(Object(r),!0).forEach(function(a){vr(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ot(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function vr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var gr=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{longitude:Ve.longitudeKeys,latitude:Ve.latitudeKeys,altitude:Ve.altitudeKeys},a=(0,Xe.default)(t,r.longitude),n=(0,Xe.default)(t,r.latitude),u=(0,Xe.default)(t,r.altitude);return cr({latitude:n,longitude:a},u?{altitude:u}:{})},_r=gr;j.default=_r;var x={};Object.defineProperty(x,"__esModule",{value:!0}),x.default=void 0;var mr=ke(E),yr=ke(q),hr=ke(K),dt=c;function ke(e){return e&&e.__esModule?e:{default:e}}var pr=function e(t){return(0,mr.default)(t)?!(parseFloat(t)>dt.MAXLAT||t<dt.MINLAT):(0,yr.default)(t)?e((0,hr.default)(t)):!1},Mr=pr;x.default=Mr;var U={};Object.defineProperty(U,"__esModule",{value:!0}),U.default=void 0;var $r=xe(E),Pr=xe(q),Or=xe(K),lt=c;function xe(e){return e&&e.__esModule?e:{default:e}}var Lr=function e(t){return(0,$r.default)(t)?!(parseFloat(t)>lt.MAXLON||t<lt.MINLON):(0,Pr.default)(t)?e((0,Or.default)(t)):!1},Dr=Lr;U.default=Dr,Object.defineProperty(k,"__esModule",{value:!0}),k.default=void 0;var br=Ue(j),ft=Ue(x),st=Ue(U);function Ue(e){return e&&e.__esModule?e:{default:e}}var Sr=function(t){var r=(0,br.default)(t),a=r.latitude,n=r.longitude;if(Array.isArray(t)&&t.length>=2)return(0,st.default)(t[0])&&(0,ft.default)(t[1]);if(typeof a>"u"||typeof n>"u")return!1;var u=t[n],i=t[a];return!(typeof i>"u"||typeof u>"u"||(0,ft.default)(i)===!1||(0,st.default)(u)===!1)},Nr=Sr;k.default=Nr,Object.defineProperty(F,"__esModule",{value:!0}),F.default=void 0;var Ar=G(E),Rr=G(q),Cr=G(K),ct=G(k),wr=G(j);function G(e){return e&&e.__esModule?e:{default:e}}function vt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Ge(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vt(Object(r),!0).forEach(function(a){Ye(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vt(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Ye(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Ir=function e(t){if((0,Ar.default)(t))return Number(t);if((0,Rr.default)(t))return(0,Cr.default)(t);if((0,ct.default)(t)){var r=(0,wr.default)(t);return Array.isArray(t)?t.map(function(a,n){return[0,1].includes(n)?e(a):a}):Ge(Ge(Ge({},t),r.latitude&&Ye({},r.latitude,e(t[r.latitude]))),r.longitude&&Ye({},r.longitude,e(t[r.longitude])))}return Array.isArray(t)?t.map(function(a){return(0,ct.default)(a)?e(a):a}):t},Tr=Ir;F.default=Tr,Object.defineProperty(L,"__esModule",{value:!0}),L.default=void 0;var Br=c,Er=gt(B),qr=gt(F);function gt(e){return e&&e.__esModule?e:{default:e}}var Kr=function(t,r){var a=(0,Er.default)(t,Br.latitudeKeys);if(!(typeof a>"u"||a===null)){var n=t[a];return r===!0?n:(0,qr.default)(n)}},Wr=Kr;L.default=Wr;var D={};Object.defineProperty(D,"__esModule",{value:!0}),D.default=void 0;var Fr=c,jr=_t(B),Vr=_t(F);function _t(e){return e&&e.__esModule?e:{default:e}}var Xr=function(t,r){var a=(0,jr.default)(t,Fr.longitudeKeys);if(!(typeof a>"u"||a===null)){var n=t[a];return r===!0?n:(0,Vr.default)(n)}},kr=Xr;D.default=kr;var S={};Object.defineProperty(S,"__esModule",{value:!0}),S.default=void 0;var xr=function(t){return t*Math.PI/180},Ur=xr;S.default=Ur;var w={};Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;var Gr=function(t){return t*180/Math.PI},Yr=Gr;w.default=Yr,Object.defineProperty(oe,"__esModule",{value:!0}),oe.default=void 0;var zr=de(L),Zr=de(D),ze=de(S),Ze=de(w),mt=c;function de(e){return e&&e.__esModule?e:{default:e}}var Hr=function(t,r,a){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:6371e3,u=(0,zr.default)(t),i=(0,Zr.default)(t),o=r/n,d=(0,ze.default)(a),s=(0,ze.default)(u),h=(0,ze.default)(i),m=Math.asin(Math.sin(s)*Math.cos(o)+Math.cos(s)*Math.sin(o)*Math.cos(d)),l=h+Math.atan2(Math.sin(d)*Math.sin(o)*Math.cos(s),Math.cos(o)-Math.sin(s)*Math.sin(m)),_=(0,Ze.default)(l);return(_<mt.MINLON||_>mt.MAXLON)&&(l=(l+3*Math.PI)%(2*Math.PI)-Math.PI,_=(0,Ze.default)(l)),{latitude:(0,Ze.default)(m),longitude:_}},Jr=Hr;oe.default=Jr;var le={};Object.defineProperty(le,"__esModule",{value:!0}),le.default=void 0;var Qr=c,ea=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"m",a=Qr.areaConversion[r];if(a)return t*a;throw new Error("Invalid unit used for area conversion.")},ta=ea;le.default=ta;var fe={};Object.defineProperty(fe,"__esModule",{value:!0}),fe.default=void 0;var ra=c,aa=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"m",a=ra.distanceConversion[r];if(a)return t*a;throw new Error("Invalid unit used for distance conversion.")},na=aa;fe.default=na;var se={};Object.defineProperty(se,"__esModule",{value:!0}),se.default=void 0;var ce=c,ua=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"kmh";switch(r){case"kmh":return t*ce.timeConversion.h*ce.distanceConversion.km;case"mph":return t*ce.timeConversion.h*ce.distanceConversion.mi;default:return t}},ia=ua;se.default=ia;var ve={};Object.defineProperty(ve,"__esModule",{value:!0}),ve.default=void 0;function yt(e,t){return fa(e)||la(e,t)||da(e,t)||oa()}function oa(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function da(e,t){if(e){if(typeof e=="string")return ht(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ht(e,t)}}function ht(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function la(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],a=!0,n=!1,u=void 0;try{for(var i=e[Symbol.iterator](),o;!(a=(o=i.next()).done)&&(r.push(o.value),!(t&&r.length===t));a=!0);}catch(d){n=!0,u=d}finally{try{!a&&i.return!=null&&i.return()}finally{if(n)throw u}}return r}}function fa(e){if(Array.isArray(e))return e}var sa=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4,a=Math.pow(10,r);return Math.round(t*a)/a},ca=function(t){var r=t.toString().split("."),a=yt(r,2),n=a[0],u=a[1],i=Math.abs(Number(n)),o=+("0."+(u||0))*60,d=o.toString().split("."),s=Math.floor(o),h=sa(+("0."+(d[1]||0))*60).toString(),m=h.split("."),l=yt(m,2),_=l[0],p=l[1],y=p===void 0?"0":p;return i+"° "+s.toString().padStart(2,"0")+"' "+_.padStart(2,"0")+"."+y.padEnd(1,"0")+'"'},va=ca;ve.default=va;var ge={},Y={},R={},z={};Object.defineProperty(z,"__esModule",{value:!0}),z.default=void 0;var ga=function(t){return t>1?1:t<-1?-1:t},_a=ga;z.default=_a,Object.defineProperty(R,"__esModule",{value:!0}),R.default=void 0;var pt=_e(L),Mt=_e(D),V=_e(S),ma=_e(z),ya=c;function _e(e){return e&&e.__esModule?e:{default:e}}var ha=function(t,r){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;a=typeof a<"u"&&!isNaN(a)?a:1;var n=(0,pt.default)(t),u=(0,Mt.default)(t),i=(0,pt.default)(r),o=(0,Mt.default)(r),d=Math.acos((0,ma.default)(Math.sin((0,V.default)(i))*Math.sin((0,V.default)(n))+Math.cos((0,V.default)(i))*Math.cos((0,V.default)(n))*Math.cos((0,V.default)(u)-(0,V.default)(o))))*ya.earthRadius;return Math.round(d/a)*a},pa=ha;R.default=pa,Object.defineProperty(Y,"__esModule",{value:!0}),Y.default=void 0;var $t=Ma(R);function Ma(e){return e&&e.__esModule?e:{default:e}}var $a=function(t,r){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:$t.default;return a=typeof a=="function"?a:$t.default,r.slice().sort(function(n,u){return a(t,n)-a(t,u)})},Pa=$a;Y.default=Pa,Object.defineProperty(ge,"__esModule",{value:!0}),ge.default=void 0;var Oa=La(Y);function La(e){return e&&e.__esModule?e:{default:e}}var Da=function(t,r){return(0,Oa.default)(t,r)[0]},ba=Da;ge.default=ba;var me={};Object.defineProperty(me,"__esModule",{value:!0}),me.default=void 0;var He=Je(S),Sa=Je(L),Pt=Je(D),Ot=c;function Je(e){return e&&e.__esModule?e:{default:e}}var Na=function(t){var r=0;if(t.length>2){for(var a,n,u,i=0;i<t.length;i++){i===t.length-2?(a=t.length-2,n=t.length-1,u=0):i===t.length-1?(a=t.length-1,n=0,u=1):(a=i,n=i+1,u=i+2);var o=(0,Pt.default)(t[a]),d=(0,Sa.default)(t[n]),s=(0,Pt.default)(t[u]);r+=((0,He.default)(s)-(0,He.default)(o))*Math.sin((0,He.default)(d))}r=r*Ot.earthRadius*Ot.earthRadius/2}return Math.abs(r)},Aa=Na;me.default=Aa;var Z={};Object.defineProperty(Z,"__esModule",{value:!0}),Z.default=void 0;var Ra=Lt(L),Ca=Lt(D);function Lt(e){return e&&e.__esModule?e:{default:e}}var wa=function(t){if(Array.isArray(t)===!1||t.length===0)throw new Error("No points were given.");return t.reduce(function(r,a){var n=(0,Ra.default)(a),u=(0,Ca.default)(a);return{maxLat:Math.max(n,r.maxLat),minLat:Math.min(n,r.minLat),maxLng:Math.max(u,r.maxLng),minLng:Math.min(u,r.minLng)}},{maxLat:-1/0,minLat:1/0,maxLng:-1/0,minLng:1/0})},Ia=wa;Z.default=Ia;var ye={};Object.defineProperty(ye,"__esModule",{value:!0}),ye.default=void 0;var Ta=pe(L),Ba=pe(D),X=pe(S),he=pe(w),H=c;function pe(e){return e&&e.__esModule?e:{default:e}}var Ea=function(t,r){var a=(0,Ta.default)(t),n=(0,Ba.default)(t),u=(0,X.default)(a),i=(0,X.default)(n),o=r/H.earthRadius,d=u-o,s=u+o,h=(0,X.default)(H.MAXLAT),m=(0,X.default)(H.MINLAT),l=(0,X.default)(H.MAXLON),_=(0,X.default)(H.MINLON),p,y;if(d>m&&s<h){var g=Math.asin(Math.sin(o)/Math.cos(u));p=i-g,p<_&&(p+=Math.PI*2),y=i+g,y>l&&(y-=Math.PI*2)}else d=Math.max(d,m),s=Math.min(s,h),p=_,y=l;return[{latitude:(0,he.default)(d),longitude:(0,he.default)(p)},{latitude:(0,he.default)(s),longitude:(0,he.default)(y)}]},qa=Ea;ye.default=qa;var Me={};Object.defineProperty(Me,"__esModule",{value:!0}),Me.default=void 0;var Ka=$e(L),Wa=$e(D),Dt=$e(S),bt=$e(w);function $e(e){return e&&e.__esModule?e:{default:e}}var Fa=function(t){if(Array.isArray(t)===!1||t.length===0)return!1;var r=t.length,a=t.reduce(function(o,d){var s=(0,Dt.default)((0,Ka.default)(d)),h=(0,Dt.default)((0,Wa.default)(d));return{X:o.X+Math.cos(s)*Math.cos(h),Y:o.Y+Math.cos(s)*Math.sin(h),Z:o.Z+Math.sin(s)}},{X:0,Y:0,Z:0}),n=a.X/r,u=a.Y/r,i=a.Z/r;return{longitude:(0,bt.default)(Math.atan2(u,n)),latitude:(0,bt.default)(Math.atan2(i,Math.sqrt(n*n+u*u)))}},ja=Fa;Me.default=ja;var Pe={};Object.defineProperty(Pe,"__esModule",{value:!0}),Pe.default=void 0;var Va=Xa(Z);function Xa(e){return e&&e.__esModule?e:{default:e}}var ka=function(t){var r=(0,Va.default)(t),a=r.minLat+(r.maxLat-r.minLat)/2,n=r.minLng+(r.maxLng-r.minLng)/2;return{latitude:parseFloat(a.toFixed(6)),longitude:parseFloat(n.toFixed(6))}},xa=ka;Pe.default=xa;var Oe={},J={};Object.defineProperty(J,"__esModule",{value:!0}),J.default=void 0;var St=De(L),Nt=De(D),Le=De(S),Ua=De(w);function De(e){return e&&e.__esModule?e:{default:e}}var Ga=function(t,r){var a=(0,Le.default)((0,Nt.default)(r))-(0,Le.default)((0,Nt.default)(t)),n=Math.log(Math.tan((0,Le.default)((0,St.default)(r))/2+Math.PI/4)/Math.tan((0,Le.default)((0,St.default)(t))/2+Math.PI/4));return Math.abs(a)>Math.PI&&(a>0?a=(Math.PI*2-a)*-1:a=Math.PI*2+a),((0,Ua.default)(Math.atan2(a,n))+360)%360},Ya=Ga;J.default=Ya,Object.defineProperty(Oe,"__esModule",{value:!0}),Oe.default=void 0;var At=za(J);function za(e){return e&&e.__esModule?e:{default:e}}var Za=function(t,r){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:At.default,n=typeof a=="function"?a(t,r):(0,At.default)(t,r);if(isNaN(n))throw new Error("Could not calculate bearing for given points. Check your bearing function");switch(Math.round(n/22.5)){case 1:return"NNE";case 2:return"NE";case 3:return"ENE";case 4:return"E";case 5:return"ESE";case 6:return"SE";case 7:return"SSE";case 8:return"S";case 9:return"SSW";case 10:return"SW";case 11:return"WSW";case 12:return"W";case 13:return"WNW";case 14:return"NW";case 15:return"NNW";default:return"N"}},Ha=Za;Oe.default=Ha;var Q={};Object.defineProperty(Q,"__esModule",{value:!0}),Q.default=void 0;var Qe=Ct(R),Rt=Ct(z);function Ct(e){return e&&e.__esModule?e:{default:e}}var Ja=function(t,r,a){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,u=(0,Qe.default)(r,t,n),i=(0,Qe.default)(t,a,n),o=(0,Qe.default)(r,a,n),d=Math.acos((0,Rt.default)((u*u+o*o-i*i)/(2*u*o))),s=Math.acos((0,Rt.default)((i*i+o*o-u*u)/(2*i*o)));return d>Math.PI/2?u:s>Math.PI/2?i:Math.sin(d)*u},Qa=Ja;Q.default=Qa;var be={};Object.defineProperty(be,"__esModule",{value:!0}),be.default=void 0;var wt=Se(L),It=Se(D),I=Se(S),en=Se(w);function Se(e){return e&&e.__esModule?e:{default:e}}var tn=function(t,r){var a=(0,wt.default)(r),n=(0,It.default)(r),u=(0,wt.default)(t),i=(0,It.default)(t),o=((0,en.default)(Math.atan2(Math.sin((0,I.default)(n)-(0,I.default)(i))*Math.cos((0,I.default)(a)),Math.cos((0,I.default)(u))*Math.sin((0,I.default)(a))-Math.sin((0,I.default)(u))*Math.cos((0,I.default)(a))*Math.cos((0,I.default)(n)-(0,I.default)(i))))+360)%360;return o},rn=tn;be.default=rn;var Ne={};Object.defineProperty(Ne,"__esModule",{value:!0}),Ne.default=void 0;var an=nn(R);function nn(e){return e&&e.__esModule?e:{default:e}}function Ae(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Ae=function(r){return typeof r}:Ae=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Ae(e)}var un=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:an.default;return t.reduce(function(a,n){return Ae(a)==="object"&&a.last!==null&&(a.distance+=r(n,a.last)),a.last=n,a},{last:null,distance:0}).distance},on=un;Ne.default=on;var Re={};Object.defineProperty(Re,"__esModule",{value:!0}),Re.default=void 0;var Tt=tt(L),Bt=tt(D),et=tt(S),Et=c;function tt(e){return e&&e.__esModule?e:{default:e}}var dn=function(t,r){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;a=typeof a<"u"&&!isNaN(a)?a:1;var n=(0,Tt.default)(t),u=(0,Bt.default)(t),i=(0,Tt.default)(r),o=(0,Bt.default)(r),d=6356752314245e-6,s=1/298.257223563,h=(0,et.default)(o-u),m,l,_,p,y,g,M=Math.atan((1-s)*Math.tan((0,et.default)(parseFloat(n)))),O=Math.atan((1-s)*Math.tan((0,et.default)(parseFloat(i)))),P=Math.sin(M),$=Math.cos(M),b=Math.sin(O),T=Math.cos(O),W=h,We,Fe=100;do{var ae=Math.sin(W),ne=Math.cos(W);if(g=Math.sqrt(T*ae*(T*ae)+($*b-P*T*ne)*($*b-P*T*ne)),g===0)return 0;m=P*b+$*T*ne,l=Math.atan2(g,m),_=$*T*ae/g,p=1-_*_,y=m-2*P*b/p,isNaN(y)&&(y=0);var ue=s/16*p*(4+s*(4-3*p));We=W,W=h+(1-ue)*s*_*(l+ue*g*(y+ue*m*(-1+2*y*y)))}while(Math.abs(W-We)>1e-12&&--Fe>0);if(Fe===0)return NaN;var C=p*(Et.earthRadius*Et.earthRadius-d*d)/(d*d),nt=1+C/16384*(4096+C*(-768+C*(320-175*C))),ie=C/1024*(256+C*(-128+C*(74-47*C))),ut=ie*g*(y+ie/4*(m*(-1+2*y*y)-ie/6*y*(-3+4*g*g)*(-3+4*y*y))),it=d*nt*(l-ut);return Math.round(it/a)*a},ln=dn;Re.default=ln;var Ce={};Object.defineProperty(Ce,"__esModule",{value:!0}),Ce.default=void 0;var fn=function(t){if(/^NNE|NE|NNW|N$/.test(t))return"N";if(/^ENE|E|ESE|SE$/.test(t))return"E";if(/^SSE|S|SSW|SW$/.test(t))return"S";if(/^WSW|W|WNW|NW$/.test(t))return"W"},sn=fn;Ce.default=sn;var we={};Object.defineProperty(we,"__esModule",{value:!0}),we.default=void 0;var cn=vn(R);function vn(e){return e&&e.__esModule?e:{default:e}}var gn=function(t,r){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:cn.default,n=a(t,r),u=Number(r.time)-Number(t.time),i=n/u*1e3;return i},_n=gn;we.default=_n;var Ie={};Object.defineProperty(Ie,"__esModule",{value:!0}),Ie.default=void 0;var rt=mn(R);function mn(e){return e&&e.__esModule?e:{default:e}}var yn=function(t,r,a){return(0,rt.default)(r,t)+(0,rt.default)(t,a)===(0,rt.default)(r,a)},hn=yn;Ie.default=hn;var Te={};Object.defineProperty(Te,"__esModule",{value:!0}),Te.default=void 0;var Be=qt(L),N=qt(D);function qt(e){return e&&e.__esModule?e:{default:e}}var pn=function(t,r){for(var a=!1,n=r.length,u=-1,i=n-1;++u<n;i=u)((0,N.default)(r[u])<=(0,N.default)(t)&&(0,N.default)(t)<(0,N.default)(r[i])||(0,N.default)(r[i])<=(0,N.default)(t)&&(0,N.default)(t)<(0,N.default)(r[u]))&&(0,Be.default)(t)<((0,Be.default)(r[i])-(0,Be.default)(r[u]))*((0,N.default)(t)-(0,N.default)(r[u]))/((0,N.default)(r[i])-(0,N.default)(r[u]))+(0,Be.default)(r[u])&&(a=!a);return a},Mn=pn;Te.default=Mn;var Ee={};Object.defineProperty(Ee,"__esModule",{value:!0}),Ee.default=void 0;var $n=Pn(Q);function Pn(e){return e&&e.__esModule?e:{default:e}}var On=function(t,r,a,n){return(0,$n.default)(t,r,a)<n},Ln=On;Ee.default=Ln;var qe={};Object.defineProperty(qe,"__esModule",{value:!0}),qe.default=void 0;var Dn=bn(R);function bn(e){return e&&e.__esModule?e:{default:e}}var Sn=function(t,r,a){return(0,Dn.default)(t,r)<a},Nn=Sn;qe.default=Nn;var Ke={};Object.defineProperty(Ke,"__esModule",{value:!0}),Ke.default=void 0;function An(e,t){return In(e)||wn(e,t)||Cn(e,t)||Rn()}function Rn(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Cn(e,t){if(e){if(typeof e=="string")return Kt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Kt(e,t)}}function Kt(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function wn(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],a=!0,n=!1,u=void 0;try{for(var i=e[Symbol.iterator](),o;!(a=(o=i.next()).done)&&(r.push(o.value),!(t&&r.length===t));a=!0);}catch(d){n=!0,u=d}finally{try{!a&&i.return!=null&&i.return()}finally{if(n)throw u}}return r}}function In(e){if(Array.isArray(e))return e}var Tn=function(t){if(!t.startsWith("POLYGON"))throw new Error("Invalid wkt.");var r=t.slice(t.indexOf("(")+2,t.indexOf(")")).split(", "),a=r.map(function(n){var u=n.split(" "),i=An(u,2),o=i[0],d=i[1];return{longitude:parseFloat(o),latitude:parseFloat(d)}});return a},Bn=Tn;Ke.default=Bn,function(e){Object.defineProperty(e,"__esModule",{value:!0});var t={computeDestinationPoint:!0,convertArea:!0,convertDistance:!0,convertSpeed:!0,decimalToSexagesimal:!0,findNearest:!0,getAreaOfPolygon:!0,getBounds:!0,getBoundsOfDistance:!0,getCenter:!0,getCenterOfBounds:!0,getCompassDirection:!0,getCoordinateKey:!0,getCoordinateKeys:!0,getDistance:!0,getDistanceFromLine:!0,getGreatCircleBearing:!0,getLatitude:!0,getLongitude:!0,getPathLength:!0,getPreciseDistance:!0,getRhumbLineBearing:!0,getRoughCompassDirection:!0,getSpeed:!0,isDecimal:!0,isPointInLine:!0,isPointInPolygon:!0,isPointNearLine:!0,isPointWithinRadius:!0,isSexagesimal:!0,isValidCoordinate:!0,isValidLatitude:!0,isValidLongitude:!0,orderByDistance:!0,sexagesimalToDecimal:!0,toDecimal:!0,toRad:!0,toDeg:!0,wktToPolygon:!0};Object.defineProperty(e,"computeDestinationPoint",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(e,"convertArea",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(e,"convertDistance",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(e,"convertSpeed",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(e,"decimalToSexagesimal",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(e,"findNearest",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(e,"getAreaOfPolygon",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(e,"getBounds",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(e,"getBoundsOfDistance",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(e,"getCenter",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(e,"getCenterOfBounds",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(e,"getCompassDirection",{enumerable:!0,get:function(){return _.default}}),Object.defineProperty(e,"getCoordinateKey",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(e,"getCoordinateKeys",{enumerable:!0,get:function(){return y.default}}),Object.defineProperty(e,"getDistance",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(e,"getDistanceFromLine",{enumerable:!0,get:function(){return M.default}}),Object.defineProperty(e,"getGreatCircleBearing",{enumerable:!0,get:function(){return O.default}}),Object.defineProperty(e,"getLatitude",{enumerable:!0,get:function(){return P.default}}),Object.defineProperty(e,"getLongitude",{enumerable:!0,get:function(){return $.default}}),Object.defineProperty(e,"getPathLength",{enumerable:!0,get:function(){return b.default}}),Object.defineProperty(e,"getPreciseDistance",{enumerable:!0,get:function(){return T.default}}),Object.defineProperty(e,"getRhumbLineBearing",{enumerable:!0,get:function(){return W.default}}),Object.defineProperty(e,"getRoughCompassDirection",{enumerable:!0,get:function(){return We.default}}),Object.defineProperty(e,"getSpeed",{enumerable:!0,get:function(){return Fe.default}}),Object.defineProperty(e,"isDecimal",{enumerable:!0,get:function(){return ae.default}}),Object.defineProperty(e,"isPointInLine",{enumerable:!0,get:function(){return ne.default}}),Object.defineProperty(e,"isPointInPolygon",{enumerable:!0,get:function(){return ue.default}}),Object.defineProperty(e,"isPointNearLine",{enumerable:!0,get:function(){return C.default}}),Object.defineProperty(e,"isPointWithinRadius",{enumerable:!0,get:function(){return nt.default}}),Object.defineProperty(e,"isSexagesimal",{enumerable:!0,get:function(){return ie.default}}),Object.defineProperty(e,"isValidCoordinate",{enumerable:!0,get:function(){return ut.default}}),Object.defineProperty(e,"isValidLatitude",{enumerable:!0,get:function(){return it.default}}),Object.defineProperty(e,"isValidLongitude",{enumerable:!0,get:function(){return jn.default}}),Object.defineProperty(e,"orderByDistance",{enumerable:!0,get:function(){return Vn.default}}),Object.defineProperty(e,"sexagesimalToDecimal",{enumerable:!0,get:function(){return Xn.default}}),Object.defineProperty(e,"toDecimal",{enumerable:!0,get:function(){return kn.default}}),Object.defineProperty(e,"toRad",{enumerable:!0,get:function(){return xn.default}}),Object.defineProperty(e,"toDeg",{enumerable:!0,get:function(){return Un.default}}),Object.defineProperty(e,"wktToPolygon",{enumerable:!0,get:function(){return Gn.default}});var r=v(oe),a=v(le),n=v(fe),u=v(se),i=v(ve),o=v(ge),d=v(me),s=v(Z),h=v(ye),m=v(Me),l=v(Pe),_=v(Oe),p=v(B),y=v(j),g=v(R),M=v(Q),O=v(be),P=v(L),$=v(D),b=v(Ne),T=v(Re),W=v(J),We=v(Ce),Fe=v(we),ae=v(E),ne=v(Ie),ue=v(Te),C=v(Ee),nt=v(qe),ie=v(q),ut=v(k),it=v(x),jn=v(U),Vn=v(Y),Xn=v(K),kn=v(F),xn=v(S),Un=v(w),Gn=v(Ke),Xt=c;Object.keys(Xt).forEach(function(f){f==="default"||f==="__esModule"||Object.prototype.hasOwnProperty.call(t,f)||Object.defineProperty(e,f,{enumerable:!0,get:function(){return Xt[f]}})});function v(f){return f&&f.__esModule?f:{default:f}}}(je);function En(e,t){const r=je.getDistance(e,t),a=je.getRhumbLineBearing(e,t),n=t[0]+r*Math.cos(a*Math.PI/180),u=t[1]+r*Math.sin(a*Math.PI/180);return[-n/100,u/100]}function qn(e){return e.split(",").map(t=>parseFloat(t))}var ee=new Map,te=new Map,Wt=new Map,Ft=new Map,jt=null;const re=(e,t)=>e[0]===t[0]&&e[1]===t[1];onmessage=e=>{console.log("Worker started"),jt=qn(e.data.centerCoords),Kn(e.data.highwayData),postMessage({roadIntersections:ee,footpathIntersections:te,roadEdges:null,footpathEdges:null}),Vt(e.data.highwayData,!0),Vt(e.data.highwayData,!1),postMessage({roadIntersections:ee,footpathIntersections:te,roadEdges:Wt,footpathEdges:Ft}),self.close()};function Vt(e,t){const r=t?ee:te,n=Object.keys(e).length,u=Math.floor(n/5);let i=0;for(let[o,d]of Object.entries(e)){const s=[],h=[];for(let[l,_]of r.entries())_.ways.has(o)&&(s.push(_.coords),h.push(l));const m=s.length;if(m==2)at(s,h,t);else if(m>2){let l=[];for(let g=0;g<m;g++)for(let M=g+1;M<m;M++){const O=s[g],P=s[M],$=(O[0]-P[0])**2+(O[1]-P[1])**2;l.push({dist:$,coords1:O,coords2:P,key1:h[g],key2:h[M]})}l.sort((g,M)=>g.dist>M.dist?1:-1);const _=l[l.length-1];l=l.map(g=>re(g.coords1,_.coords1)||re(g.coords2,_.coords1)?g:void 0),l.sort((g,M)=>g.dist>M.dist?1:-1);let p,y;re(l[0].coords1,_.coords1)?(p=l[0].coords2,y=l[0].key2):(p=l[0].coords1,y=l[0].key1),at([_.coords1,p],[_.key1,y],t);for(let g=0;g<m-2;g++){const M=g+1;let O,P;re(l[g].coords1,_.coords1)?(O=l[g].coords2,P=l[g].key2):(O=l[g].coords1,P=l[g].key1);let $,b;re(l[M].coords1,_.coords1)?($=l[M].coords2,b=l[M].key2):($=l[M].coords1,b=l[M].key1),at([O,$],[P,b],t)}}(i+1)%u===0&&postMessage({progress:10*(Math.floor((i+1)/u)+(t?0:5))}),i++}t||postMessage({progress:110})}function at([e,t],[r,a],n){const u=n?Wt:Ft,i=Math.sqrt((e[0]-t[0])**2+(e[1]-t[1])**2),o=u.get(r),d=u.get(a);o?o.push({dist:i,neighbor:a}):u.set(r,[{dist:i,neighbor:a}]),d?d.push({dist:i,neighbor:r}):u.set(a,[{dist:i,neighbor:r}])}function Kn(e){const t=Date.now();let r=0;const a=Object.keys(e),n=a.length*(a.length-1)/2,u=Math.floor(n/10);let i=0;for(let d=0;d<a.length;d++){const s=a[d];for(let h=d+1;h<a.length;h++){const m=a[h],l=e[s].array,_=e[m].array,p=e[s].isRoad&&e[m].isRoad,y=e[s].isFootpath&&e[m].isFootpath;(p||y)&&(r=Wn(l,_,s,m,p,y,r)),(i+1)%u===0&&postMessage({progress:10*Math.floor((i+1)/u)}),i++}}const o=Date.now()-t;return console.log(`Found ${r} intersections of highways in ${o} ms`),!0}function Wn(e,t,r,a,n,u,i){for(let o=3;o<e.length;o+=2)for(let d=3;d<t.length;d+=2){const s=e[o-3],h=e[o-2],m=e[o-1],l=e[o],_=t[d-3],p=t[d-2],y=t[d-1],g=t[d],M=Fn(s,h,m,l,_,p,y,g);if(M){const O=En(M,jt),P=O.toString();if(n){const $=ee.get(P);if($)$.ways.add(r),$.ways.add(a);else{const b=new Set([r,a]);ee.set(P,{coords:O,ways:b})}}if(u){const $=te.get(P);if($)$.ways.add(r),$.ways.add(a);else{const b=new Set([r,a]);te.set(P,{coords:O,ways:b})}}i++}}return i}function Fn(e,t,r,a,n,u,i,o){let d,s,h,m;d=r-e,s=a-t,h=i-n,m=o-u;let l,_;if(l=(-s*(e-n)+d*(t-u))/(-h*s+d*m),_=(h*(t-u)-m*(e-n))/(-h*s+d*m),l>=0&&l<=1&&_>=0&&_<=1){const p=e+_*d,y=t+_*s;return[p,y]}return!1}})();
